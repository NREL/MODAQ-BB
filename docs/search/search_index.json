{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"MODAQ BlackBox Documentation Until this message is removed, this guide is in draft and actively being edited. During this time, some sections may be blank or not fully developed. General Overview The National Renewable Energy Laboratory (NREL), under funding from the Department of Energy's Water Power Technologies Office , has developed a compact, rapid deployment data acquisition system that can withstand water depths up to 400m. Codenamed \"BlackBox\" (or simply BB), since its initial purpose was to track marine assets and record vital data streams that could later be recovered in the event of a mishap - much like a traditional black box used in aviation and shipping, the name has stuck. MODAQ BlackBox is a battery-operable microcontroller platform with internal inertial sensing, GPS, satellite communications, and additional I/O (input/output) support in a depth-rated pressure enclosure. Since BB is self-contained and relatively compact, it can be quickly deployed with minimal effort. The enclosure can be clamped to a tube (such as part of a railing) or mast in a location with unobstructed view of the sky using the available clamp accessory or a common hose clamp. While BB is designed to operate unattended, users can configure what data are uploaded and the frequency of satellite transmissions. Once data are uploaded, they can be relayed to an email distribution list, MODAQ:Web operational dashboard, or custom destination. BB has found utility in NREL Waterpower projects beyond its original vision and has been configured and successfully deployed in more traditional data-gathering applications where a simple, battery-operated solution was indicated. As part of the MODAQ family, BB fills a space in the spectrum of missions can be supported that were previously impractical using the traditional MODAQ hardware architecture due to factors such as weight, size, and cost.","title":"Home"},{"location":"#modaq-blackbox-documentation","text":"Until this message is removed, this guide is in draft and actively being edited. During this time, some sections may be blank or not fully developed.","title":"MODAQ BlackBox Documentation "},{"location":"#general-overview","text":"The National Renewable Energy Laboratory (NREL), under funding from the Department of Energy's Water Power Technologies Office , has developed a compact, rapid deployment data acquisition system that can withstand water depths up to 400m. Codenamed \"BlackBox\" (or simply BB), since its initial purpose was to track marine assets and record vital data streams that could later be recovered in the event of a mishap - much like a traditional black box used in aviation and shipping, the name has stuck. MODAQ BlackBox is a battery-operable microcontroller platform with internal inertial sensing, GPS, satellite communications, and additional I/O (input/output) support in a depth-rated pressure enclosure. Since BB is self-contained and relatively compact, it can be quickly deployed with minimal effort. The enclosure can be clamped to a tube (such as part of a railing) or mast in a location with unobstructed view of the sky using the available clamp accessory or a common hose clamp. While BB is designed to operate unattended, users can configure what data are uploaded and the frequency of satellite transmissions. Once data are uploaded, they can be relayed to an email distribution list, MODAQ:Web operational dashboard, or custom destination. BB has found utility in NREL Waterpower projects beyond its original vision and has been configured and successfully deployed in more traditional data-gathering applications where a simple, battery-operated solution was indicated. As part of the MODAQ family, BB fills a space in the spectrum of missions can be supported that were previously impractical using the traditional MODAQ hardware architecture due to factors such as weight, size, and cost.","title":"General Overview"},{"location":"FAQ/","text":"FAQ Why build an asset tracker when there are commercially-available devices specifically for this purpose? When the notion of having a tracker was first presented, our first thought was that we would source something 'off the shelf'. We conducted a search and considered a variety of options targeted to both the private and commercial marine market such as purposeful asset trackers, voyage data recorders , and even repurposing lagrangian-drifter beacons. Aside from simple location tracking, the requirements expanded to include acquisition of external data streams, auxiliary data storage (backup/mirror of primary DAQ), and flexible communications options. There were also a number of other requirements such as positive buoyancy, can operate on batteries for a specific period of time, survive at depths of at least a few 100m, strobe light, and acoustic pinger. These requirements were prioritized into 'must-haves' and 'added-as-needed' (meaning we needed to have a solution if a specific project required it). The commercial options reviewed all had strengths and weaknesses to differing degrees on most of the requirements- which included things like: Proprietary or closed systems Ecosystem lock-in or subscription charges Limited external interfacing (usually limited to common marine or aviation electronics) Limited programming or configuration options Too bulky or difficult form-factor Lack (sufficient) onboard storage Limited documentation or unknown specifications of key features Some were rugged and submersible, others not so much It became clear that adapting the most promising candidates would be time consuming and the end result would likely be something that still falls short of requirements- a bit of a kludge. This would be difficult to assure to our sponsors that we're presenting the best solution for their ask and that it will work to expectations. This brought us to the conclusion to design our own system.","title":"FAQ"},{"location":"FAQ/#faq","text":"","title":"FAQ"},{"location":"FAQ/#why-build-an-asset-tracker-when-there-are-commercially-available-devices-specifically-for-this-purpose","text":"When the notion of having a tracker was first presented, our first thought was that we would source something 'off the shelf'. We conducted a search and considered a variety of options targeted to both the private and commercial marine market such as purposeful asset trackers, voyage data recorders , and even repurposing lagrangian-drifter beacons. Aside from simple location tracking, the requirements expanded to include acquisition of external data streams, auxiliary data storage (backup/mirror of primary DAQ), and flexible communications options. There were also a number of other requirements such as positive buoyancy, can operate on batteries for a specific period of time, survive at depths of at least a few 100m, strobe light, and acoustic pinger. These requirements were prioritized into 'must-haves' and 'added-as-needed' (meaning we needed to have a solution if a specific project required it). The commercial options reviewed all had strengths and weaknesses to differing degrees on most of the requirements- which included things like: Proprietary or closed systems Ecosystem lock-in or subscription charges Limited external interfacing (usually limited to common marine or aviation electronics) Limited programming or configuration options Too bulky or difficult form-factor Lack (sufficient) onboard storage Limited documentation or unknown specifications of key features Some were rugged and submersible, others not so much It became clear that adapting the most promising candidates would be time consuming and the end result would likely be something that still falls short of requirements- a bit of a kludge. This would be difficult to assure to our sponsors that we're presenting the best solution for their ask and that it will work to expectations. This brought us to the conclusion to design our own system.","title":"Why build an asset tracker when there are commercially-available devices specifically for this purpose?"},{"location":"about/","text":"","title":"About"},{"location":"dev_modules/","text":"","title":"Optional Modules"},{"location":"h_architecture/","text":"MODAQ BlackBox Hardware Architecture General Aside from the functional requirements laid out in the General Overview section, we had several design goals for the BlackBox platform, namely: Low cost hardware Widely available components Popular software development language Open-source libraries for peripherals Strong community support for all of the above There were also several practical goals to the design: Flexible power modes to minimize power consumption when needed Reasonably performant and reliable components Flexible I/O options Compact size Controller The development of MODAQ BlackBox began at a time when computer chip shortages were reaching its peak and many popular microcontroller (MCU) and microprocessor development platforms were in tight supply or had excessive markups. We looked at a number of MCU options that met our goals that managed to largely avoid the supply and pricing issues, such as Arduino, Teensy, and STM32, but ultimately selected the ESP32 platform. While we could have used any of the other platforms mentioned (and we did test them), the ESP32 has strong adoption in the Maker Community and there are commercial industrial controllers and PLCs based on the ESP32. What we like about the ESP32 is its very low cost, tiny form factor, fast 240 MHz dual-core processor, large system memory, FreeRTOS support, ample I/O options, and selectable power and sleep modes. In addition, the ESP32 System on a Chip (SoC) is available by itself for inclusion in custom circuit board designs or as a development board with breadboard/protoboard friendly pinouts, USB controller, and a voltage regulator. There are numerous vendors, including Adafruit and Sparkfun , that offer custom development board variants, but most follow a similar a similar design to the \" DevKit C \" layout, which is what we used. Modules RTC GPS Iridium Modem IMU Storage ADC Strain Bridge Power Schematic Enclosure tube 3d bits","title":"Hardware Overview"},{"location":"h_architecture/#modaq-blackbox-hardware-architecture","text":"","title":"MODAQ BlackBox Hardware Architecture"},{"location":"h_architecture/#general","text":"Aside from the functional requirements laid out in the General Overview section, we had several design goals for the BlackBox platform, namely: Low cost hardware Widely available components Popular software development language Open-source libraries for peripherals Strong community support for all of the above There were also several practical goals to the design: Flexible power modes to minimize power consumption when needed Reasonably performant and reliable components Flexible I/O options Compact size","title":"General"},{"location":"h_architecture/#controller","text":"The development of MODAQ BlackBox began at a time when computer chip shortages were reaching its peak and many popular microcontroller (MCU) and microprocessor development platforms were in tight supply or had excessive markups. We looked at a number of MCU options that met our goals that managed to largely avoid the supply and pricing issues, such as Arduino, Teensy, and STM32, but ultimately selected the ESP32 platform. While we could have used any of the other platforms mentioned (and we did test them), the ESP32 has strong adoption in the Maker Community and there are commercial industrial controllers and PLCs based on the ESP32. What we like about the ESP32 is its very low cost, tiny form factor, fast 240 MHz dual-core processor, large system memory, FreeRTOS support, ample I/O options, and selectable power and sleep modes. In addition, the ESP32 System on a Chip (SoC) is available by itself for inclusion in custom circuit board designs or as a development board with breadboard/protoboard friendly pinouts, USB controller, and a voltage regulator. There are numerous vendors, including Adafruit and Sparkfun , that offer custom development board variants, but most follow a similar a similar design to the \" DevKit C \" layout, which is what we used.","title":"Controller"},{"location":"h_architecture/#modules","text":"","title":"Modules"},{"location":"h_architecture/#rtc","text":"","title":"RTC"},{"location":"h_architecture/#gps","text":"","title":"GPS"},{"location":"h_architecture/#iridium-modem","text":"","title":"Iridium Modem"},{"location":"h_architecture/#imu","text":"","title":"IMU"},{"location":"h_architecture/#storage","text":"","title":"Storage"},{"location":"h_architecture/#adc","text":"","title":"ADC"},{"location":"h_architecture/#strain-bridge","text":"","title":"Strain Bridge"},{"location":"h_architecture/#power","text":"","title":"Power"},{"location":"h_architecture/#schematic","text":"","title":"Schematic"},{"location":"h_architecture/#enclosure","text":"","title":"Enclosure"},{"location":"h_architecture/#tube","text":"","title":"tube"},{"location":"h_architecture/#3d-bits","text":"","title":"3d bits"},{"location":"links/","text":"","title":"Useful Links"},{"location":"ref_design/","text":"","title":"Ref design"},{"location":"s_architecture/","text":"","title":"Software Overview"},{"location":"tech_ref/","text":"Technical Reference Manual Pressure housing The MODAQ BB design presented here uses the BlueRobotics aluminum subsea housing with an inner diameter of 75mm (3\") and 240mm (9.5\") in length. For radio transparency, we selected the acrylic blank endcap for one end of the housing. Acrylic parts affect the maximum depth rating of the system, however it was necessary for the GPS and satellite radios to function. Maximum possible depth rating for BlueRobotics housings is 950m. The following selections will impact the depth rating: Flat acrylic endcap derate depth to 400m Dome acrylic endcap derate depth to 750m Aluminum endcap full depth rating 950m Swap aluminum tube for transparent acrylic, derates from 125m to 300m depending on length of tube For completely submerged applications,","title":"Technical Reference"},{"location":"tech_ref/#technical-reference-manual","text":"","title":"Technical Reference Manual"},{"location":"tech_ref/#pressure-housing","text":"The MODAQ BB design presented here uses the BlueRobotics aluminum subsea housing with an inner diameter of 75mm (3\") and 240mm (9.5\") in length. For radio transparency, we selected the acrylic blank endcap for one end of the housing. Acrylic parts affect the maximum depth rating of the system, however it was necessary for the GPS and satellite radios to function. Maximum possible depth rating for BlueRobotics housings is 950m. The following selections will impact the depth rating: Flat acrylic endcap derate depth to 400m Dome acrylic endcap derate depth to 750m Aluminum endcap full depth rating 950m Swap aluminum tube for transparent acrylic, derates from 125m to 300m depending on length of tube For completely submerged applications,","title":"Pressure housing"}]}